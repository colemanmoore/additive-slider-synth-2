(this["webpackJsonpadditive-slider-synth-2"]=this["webpackJsonpadditive-slider-synth-2"]||[]).push([[0],{12:function(e,t,n){},14:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),c=n(5),s=n.n(c),a=(n(12),n(2)),r=n(3),u=o.a.createContext(),l=function(e){var t,n=e.sliderHeight,o=void 0===n?100:n,c=e.initialLevel,s=void 0===c?0:c,r=Object(i.useState)(5),u=Object(a.a)(r,2),l=u[0],d=u[1],f=Object(i.useState)(s),h=Object(a.a)(f,2),v=h[0],b=h[1],j=function e(){document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",e)},x=function(e){var n=e.pageX,i=e.layerY;b((o-i)/o);var c,s,a,r=n-t;0!==r&&d((c=0,s=l+r,a=10,Math.min(Math.max(c,s),a)))};return[v,l,function(e){var n=e.pageX;t=n,document.addEventListener("mousemove",x),document.addEventListener("mouseup",j)},j,function(){b(0===v?.5:0)}]},d="#ff4499",f="#b3dbac",h="ASDFGHJKL",v=n(1),b=300;var j={height:"".concat(b,"px"),width:"50px",float:"left",marginRight:"2px"},x={backgroundColor:"#2a282a",border:"black 1px solid",width:"40px",height:"".concat(b,"px"),position:"relative",left:"5px",cursor:"grab",display:"flex",flexDirection:"column",justifyContent:"flex-end"},O=function(e){var t=e.pid,n=e.noteOn,o=Object(i.useContext)(u),c=o.voice(t),s=Object(i.useState)(d),h=Object(a.a)(s,2),O=h[0],m=h[1],p=l({sliderHeight:b,initialLevel:c?c.vca.gain.value:0}),y=Object(a.a)(p,5),g=y[0],C=y[1],k=y[2],w=y[3],G=y[4];return Object(i.useEffect)((function(){isNaN(g)||o.voiceGain(t,g)}),[g,o,t]),Object(i.useEffect)((function(){o.voiceDetune(t,C)}),[C,o,t]),Object(i.useEffect)((function(){m(n?f:d)}),[n]),Object(v.jsx)("div",{style:j,onMouseDown:k,onMouseUp:w,onDoubleClick:function(){o.resumeAudio(),G()},children:Object(v.jsx)("div",{style:Object(r.a)(Object(r.a)({},x),{},{left:"".concat(C,"px")}),children:Object(v.jsx)("div",{style:{height:"".concat(g*b,"px"),background:O,transition:"height 0.08s"}})})})},m=function(){var e=Object(i.useState)(!1),t=Object(a.a)(e,2),n=t[0],o=t[1],c=Object(i.useState)(!1),s=Object(a.a)(c,2),r=s[0],u=s[1];return Object(i.useEffect)((function(){n&&(u(!0),setTimeout((function(){u(!1)}),100)),n||u(!1)}),[n]),[r,o]},p={minWidth:"700px",margin:"100px auto 50px",position:"relative",display:"flex",flexDirection:"column",justifyContent:"space-evenly"},y={padding:"50px"},g={border:"1px solid #ffffff",color:"#ffffff",fontSize:"1.2rem",letterSpacing:"4px",padding:"10px 20px",borderRadius:"8px",cursor:"pointer"},C={color:"#f49",fontFamily:"sans-serif",letterSpacing:"3px",fontSize:"1.8rem",lineHeight:"2.15rem",marginBottom:"0.25rem"},k=function(){var e=Object(i.useContext)(u),t=m(),n=Object(a.a)(t,2),o=n[0],c=n[1],s=Object(i.useRef)(null),r=Object(i.useState)([]),l=Object(a.a)(r,2),b=l[0],j=l[1],x=Object(i.useState)(e.waveform),k=Object(a.a)(x,2),w=k[0],G=k[1],S=Object(i.useState)(null),A=Object(a.a)(S,2),E=A[0],F=A[1],T=Object(i.useState)(null),V=Object(a.a)(T,2),D=V[0],L=V[1];Object(i.useEffect)((function(){s.current.focus()}),[]),Object(i.useEffect)((function(){j(Object.keys(e.voices))}),[e,e.voices,e.voicesConnected]),Object(i.useEffect)((function(){e&&e.masterGain>0&&(c(!0),setTimeout((function(){return c(!1)}),100))}),[e,e.masterGain,c]),Object(i.useEffect)((function(){F(D?Object(v.jsx)("strong",{style:{color:d},children:Array.from(h).map((function(e){return e===D?Object(v.jsx)("span",{style:{color:f},children:e},e):e}))}):Object(v.jsx)("strong",{style:{color:d},children:h}))}),[D]);return Object(v.jsxs)("div",{style:p,onKeyDown:function(t){var n=t.keyCode;e.keyboardInput(n),L({65:"A",83:"S",68:"D",70:"F",71:"G",72:"H",74:"J",75:"K",76:"L"}[n]||null),c(!0)},onKeyUp:function(){e.keyboardInput(e.OFF),L(null),c(!1)},ref:s,tabIndex:"0",children:[Object(v.jsxs)("div",{children:[b.map((function(e){return Object(v.jsx)(O,{pid:e,noteOn:o},e)})),Object(v.jsx)("div",{style:{color:"#ff5"},children:e.voices.length})]}),Object(v.jsx)("div",{style:y,children:Object(v.jsx)("span",{style:g,onClick:function(){G(e.changeWave())},children:w})}),Object(v.jsxs)("div",{style:C,children:["press a key: ",E]})]})},w=n(6),G=n(7),S=function(){function e(t){var n=t.numberOfVoices,i=void 0===n?12:n,o=t.waveform,c=void 0===o?"sine":o;Object(w.a)(this,e),this.OFF="OFF",this.audioContext=null,this.voices={},this.numberOfVoices=0,this.voicesConnected=!1,this.waveform=null,this.numberOfVoices=i,this.waveform=c}return Object(G.a)(e,[{key:"resumeAudio",value:function(){if(!window.AudioContext&&!window.webkitAudioContext)return console.error("Browser does not support audio context"),void(this.voicesConnected=!1);this.audioContext?"suspended"===this.audioContext.state&&(console.log("resuming audio context..."),this.audioContext.resume()):(console.log("creating audio context..."),this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.masterGain=this.audioContext.createGain()),this.voicesConnected||this.connectAllVoices()}},{key:"connectAllVoices",value:function(){this.masterGain.disconnect();for(var e=0;e<this.numberOfVoices;e++){var t=this.audioContext.createGain();t.gain.value=0===e?.5:0,t.connect(this.masterGain);var n=this.audioContext.createOscillator();n.type="sine",n.frequency.value=0,n.start(),n.connect(t),this.voices[e]={osc:n,vca:t}}this.masterGain.connect(this.audioContext.destination),this.voicesConnected=!0}},{key:"disconnectAllVoices",value:function(){for(var e=0;e<this.numberOfVoices;e++){var t=this.voices[e],n=t.osc,i=t.vca;i.disconnect(this.masterGain),n.disconnect(i),n.stop()}this.voices={},this.voicesConnected=!1}},{key:"voice",value:function(e){return this.voices[e]}},{key:"changeMasterGain",value:function(e){this.masterGain.gain.cancelScheduledValues(this.audioContext.currentTime),this.masterGain.gain.setTargetAtTime(e,this.audioContext.currentTime,.2)}},{key:"noteChange",value:function(e){var t=this;Object.keys(this.voices).filter((function(e){return!isNaN(parseInt(e))})).forEach((function(n){t.voice(n).osc.frequency.value=e*(parseInt(n)+1)}))}},{key:"keyboardInput",value:function(e){e!==this.OFF?this.keyToFrequency(e)&&(this.noteChange(this.keyToFrequency(e)/2),this.changeMasterGain(1)):this.changeMasterGain(0)}},{key:"voiceGain",value:function(e,t){this.voices[e]&&(this.voices[e].vca.gain.value=t/this.numberOfVoices)}},{key:"voiceDetune",value:function(e,t){this.voices[e]&&(this.voices[e].osc.detune.value=5*t)}},{key:"changeWave",value:function(){var e=this,t="triangle"===this.waveform?"sine":"triangle";return Object.keys(this.voices).forEach((function(n){e.voices[n].osc.type=t})),this.waveform=t,this.masterGain.gain.cancelScheduledValues(this.audioContext.currentTime),this.masterGain.gain.setTargetAtTime(0,this.audioContext.currentTime,.2),t}},{key:"keyToFrequency",value:function(e){var t={65:"a",83:"d",68:"e",70:"fsh",71:"g",72:"a",74:"b",75:"c8",76:"d8"};if(t[e])return{c:261.6,csh:277.2,d:297.7,dsh:311.1,e:329.6,f:349.2,fsh:370,g:392,gsh:415.3,a:440,ash:466.2,b:493.9,c8:523.2,d8:595.4}[t[e]]}}]),e}();var A={textAlign:"center",display:"flex",flexDirection:"column",padding:"50px"},E=function(){var e=new S({numberOfVoices:16});e.voiceGain(0,0,5);var t=Object(i.useRef)(null);return Object(v.jsx)("div",{style:A,onFocus:function(){e.resumeAudio()},ref:t,children:Object(v.jsx)(u.Provider,{value:e,children:Object(v.jsx)(k,{})})})};s.a.render(Object(v.jsx)(o.a.StrictMode,{children:Object(v.jsx)(E,{})}),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.073a10ad.chunk.js.map